# エージェント運用における必須構成（最終・単一ファイル版）

このリポジトリでの出力は日本語で行うこと。

## 目的
- 会話記憶に依存せず、ファイルを記憶媒体として使う
- タスク単位で「要件 → 調査 → 設計 → 調査 → 判断 → 実装」を必ず踏ませる
- エージェント再起動後も同じ地点から再開できるようにする

---

## 必須ファイル構成（最小）

AGENTS.md

tasks/
  TASK-YYYYMMDD-HHMM__slug/
    status.md
    requirements.md
    research.md
    design.md

※ 上記以外は必須ではない

---

## 各ファイルの役割（これだけ覚えればいい）

### AGENTS.md
- エージェントの入口（Codex が自動で読む）
- 「思い出す」「実装したい」など、すべての行動の起点
- 参照順・フェーズ順・Gate停止を強制する
- **ルール本文は書かない。どこを見るかだけを書く**

---

### tasks/{TASK-ID}/status.md
- このタスクの「現在地」
- Phase / Gate / 承認状況の唯一の正
- 再起動時の復元点

---

### tasks/{TASK-ID}/requirements.md
- 要件の正（Gate 0 対象）
- 設計・実装の前提
- 承認されるまで次フェーズに進めない

---

### tasks/{TASK-ID}/research.md
- 調査ログ・判断根拠の保存先
- 要件 ↔ 設計 を往復させるための中核
- 「なぜそう判断したか」を残す＝擬似記憶の要

---

### tasks/{TASK-ID}/design.md
- 詳細設計（Gate 1 対象）
- 実装前に思考を固定する場所
- 承認されるまで実装不可

---

## 基本フロー（B：調査を往復させる形）

Phase 0: 要件定義の作成・更新 ↔ 調査  
Gate 0: 要件承認（ここで必ず停止）

Phase 1: 詳細設計の作成・更新 ↔ 調査  
Gate 1: 設計承認（ここで必ず停止）

Phase 2: 実装

---

## 運用ルール（最小）

- 作業は必ずタスク単位で行う
- 実装したいと感じたら、必ず要件に戻る
- 調査は自動で行ってよいが、Gate 中・承認待ちは勝手に進まない
- 承認は「OK」という単独メッセージのみ有効
- ファイルに書いていないことは「思い出せない」
- アーカイブ対象は「完了／中止／保留」。
- 対象になったタスクは `tasks/archive/YYYY/` へ移動する。

---

## これで保証されること

- エージェントを立ち上げ直しても再開できる
- 「〇〇について思い出して」がファイル再読で成立する
- 要件なし・設計なしで実装に突っ込まない
- 調査が無限ループしない
- 判断は人、作業はエージェントに分離できる

---

## 結論（1行）

必須なのは  
**AGENTS.md ＋ 各タスクに status / requirements / research / design**  
これだけで運用は成立する。

